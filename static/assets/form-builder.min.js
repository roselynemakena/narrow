/*
formBuilder - git@github.com:kevinchappell/formBuilder.git
Version: 1.5.2
Author: Kevin Chappell <kevin.b.chappell@gmail.com>
*/
"use strict";!function(e){var t=function(t,l){var a={theme:"fresh",labels:{off:"Off",on:"On"}},s=e.extend(a,l),i=e('<div class="kc-toggle"/>').insertAfter(t).append(t);i.toggleClass("on",t.is(":checked"));var o='<div class="kct-on">'+s.labels.on+"</div>",n='<div class="kct-off">'+s.labels.off+"</div>",r='<div class="kct-handle"></div>',c='<div class="kct-inner">'+o+r+n+"</div>";i.append(c),i.click(function(){t.attr("checked",!t.attr("checked")),e(this).toggleClass("on")})};e.fn.kcToggle=function(l){var a=this;return a.each(function(){var a=e(this);if(!a.data("kcToggle")){var s=new t(a,l);a.data("kcToggle",s)}})}}(jQuery),function(e){var t=function(t,l){var a,s,i={disableFields:{},defaultFields:[],roles:{1:"Administrator"},showWarning:!1,serializePrefix:"frmb",messages:{add:"Add Item",allowSelect:"Allow Select",autocomplete:"Autocomplete",cannotBeEmpty:"This field cannot be empty",checkboxGroup:"Checkbox Group",checkbox:"Checkbox",checkboxes:"Checkboxes",clearAllMessage:"Are you sure you want to remove all items?",clearAll:"Clear All",close:"Close",copy:"Copy To Clipboard",dateField:"Date Field",description:"Help Text",descriptionField:"Description",devMode:"Developer Mode",disableFields:"These fields cannot be moved.",editNames:"Edit Names",editorTitle:"Form Elements",editXML:"Edit XML",fieldVars:"Field Variables",fieldRemoveWarning:"Are you sure you want to remove this field?",getStarted:"Drag a field from the right to this area",hide:"Edit",label:"Label",labelEmpty:"Field Label cannot be empty",limitRole:"Limit access to one or more of the following roles:",mandatory:"Mandatory",maxLength:"Max Length",minOptionMessage:"This field requires a minimum of 2 options",name:"Name",no:"No",off:"Off",on:"On",optional:"optional",optionLabelPlaceholder:"Label",optionValuePlaceholder:"Value",optionEmpty:"Option value required",paragraph:"Paragraph",preview:"Preview",radioGroup:"Radio Group",radio:"Radio",removeMessage:"Remove Element",remove:"&#215;",required:"Required",richText:"Rich Text Editor",roles:"Access",save:"",selectOptions:"Select Items",select:"Select",selectionsMessage:"Allow Multiple Selections",text:"Text Field",toggle:"Toggle",warning:"Warning!",viewXML:"",yes:"Yes"}},o={};o.startMoving=function(t,l){t=t,l.item.addClass("moving"),a=e("li",this).index(l.item)},o.stopMoving=function(t,l){t=t,l.item.removeClass("moving"),s&&(e(l.sender).sortable("cancel"),e(this).sortable("cancel"))},o.safename=function(e){return e.replace(/\s/g,"-").replace(/[^a-zA-Z0-9\-]/g,"").toLowerCase()},o.forceNumber=function(e){return e.replace(/[^0-9]/g,"")},o.initTooltip=function(e){var t=e.find(".tooltip");e.mouseenter(function(){t.outerWidth()>200&&t.addClass("max-width"),t.css("left",e.width()+14),t.stop(!0,!0).fadeIn("fast")}).mouseleave(function(){e.find(".tooltip").stop(!0,!0).fadeOut("fast")}),t.hide()},o.save=function(){N.children("li").not(".disabled").each(function(){o.updatePreview(e(this))}),r.val(N.toXML())},o.updatePreview=function(t){var l=t.attr("class"),a=e(".prev-holder",t);if(-1===l.indexOf("ui-sortable-handle")){l=l.replace(" form-field","");var s,i={type:l,label:e(".fld-label",t).val()};"checkbox"===l&&(i.toggle=e(".checkbox-toggle",t).is(":checked")),l.match(/(select|checkbox-group|radio-group)/)&&(i.values=[],e(".sortable-options li",t).each(function(){var t={};t.selected=e(".select-option",e(this)).is(":checked"),t.value=e(".option-value",e(this)).val(),t.label=e(".option-label",e(this)).val(),i.values.push(t)})),s=j(i),a.html(s),e("input[toggle]",a).kcToggle()}},o.updateMultipleSelect=function(){N.delegate('input[name="multiple"]',"change",function(){var t=e(this).parents(".fields:eq(0)").find(".sortable-options input.select-option");this.checked?t.each(function(){e(this).prop("type","checkbox")}):t.each(function(){e(this).removeAttr("checked").prop("type","radio")})})},o.htmlEncode=function(t){return e("<div/>").text(t).html()},o.htmlDecode=function(t){return e("<div/>").html(t).text()},o.validateForm=function(){var t=[];e('input[name="label"], input[type="text"].option',N).each(function(){if(""===e(this).val()){var l=e(this).parents("li.form-field"),a=e(this);t.push({field:l,error:n.messages.labelEmpty,attribute:a})}}),t.length&&(alert("Error: "+t[0].error),e("html, body").animate({scrollTop:t[0].field.offset().top},1e3,function(){var l=e(".toggle-form",t[0].field).attr("id");e(".toggle-form",t[0].field).addClass("open").parent().next(".prev-holder").slideUp(250),e("#"+l+"-fld").slideDown(250,function(){t[0].attribute.addClass("error")})}))},o.disabledTT=function(t){var l=t.attr("data-tooltip");if(l){t.removeAttr("title").data("tip_text",l);var a=e("<p/>",{"class":"frmb-tt"}).html(l);t.append(a),a.css({top:-a.outerHeight(),left:-15}),t.mouseleave(function(){e(this).attr("data-tooltip",t.data("tip_text")),e(".frmb-tt").remove()})}};for(var n=e.extend(i,l),r=e(t),c="frmb-"+e("ul[id^=frmb-]").length++,d="",p=1,m=c+"-control-box",u=[{label:n.messages.text,attrs:{type:"text",className:"text-input",name:"text-input"}},{label:n.messages.select,attrs:{type:"select",className:"select",name:"select"}},{label:n.messages.richText,attrs:{type:"rich-text",className:"rich-text",name:"rich-text"}},{label:n.messages.radioGroup,attrs:{type:"radio-group",className:"radio-group",name:"radio-group"}},{label:n.messages.checkboxGroup,attrs:{type:"checkbox-group",className:"checkbox-group",name:"checkbox-group"}},{label:n.messages.checkbox,attrs:{type:"checkbox",className:"checkbox",name:"checkbox"}},{label:n.messages.dateField,attrs:{type:"date",className:"calendar",name:"date-input"}},{label:n.messages.autocomplete,attrs:{type:"autocomplete",className:"autocomplete",name:"autocomplete"}}],f=e("<ul/>",{id:m,"class":"frmb-control"}),v=u.length-1;v>=0;v--){var h=e("<li/>",{"class":"icon-"+u[v].attrs.className,type:u[v].type,name:u[v].className,label:u[v].label});for(var g in u[v])u[v].hasOwnProperty(g)&&h.data(g,u[v][g]);h.html(u[v].label).appendTo(f)}var b=e("<h4/>").html(n.messages.editorTitle),x=(e("<h4/>").html(n.messages.preview),e("<a/>",{id:c+"-export-xml",text:n.messages.viewXML,href:"#","class":"view-xml"})),k=e("<a/>",{id:c+"-allow-select",text:n.messages.allowSelect,href:"#","class":"allow-select"}).prop("checked","checked"),y=e("<a/>",{id:c+"-edit-xml",text:n.messages.editXML,href:"#","class":"edit-xml"}),w=e("<a/>",{id:c+"-edit-names",text:n.messages.editNames,href:"#","class":"edit-names"}),T=e("<a/>",{id:c+"-clear-all",text:n.messages.clearAll,href:"#","class":"clear-all"}),C=e("<div/>",{id:c+"-save",href:"#","class":"save-btn-wrap",title:n.messages.save}).html('<a class="save fb-button primary"><span>'+n.messages.save+"</span></a>"),_=e("<div/>",{id:c+"-action-links-inner","class":"action-links-inner"}).append(y," | ",w," | ",k," | ",T," |&nbsp;"),M=e("<span/>",{"class":"dev-mode-link"}).html(n.messages.devMode+" "+n.messages.off),E=e("<div/>",{id:c+"-action-links","class":"action-links"}).append(_,M),N=e("<ul/>").attr("id",c).addClass("frmb").sortable({cursor:"move",opacity:.9,beforeStop:function(t,l){var a=e("> li",N).length-1,i=l.placeholder.index();s=1>=i||i===a},start:o.startMoving,stop:o.stopMoving,cancel:"input, .disabled, .sortable-options, .add, .btn, .no-drag",receive:function(e,t){},placeholder:"frmb-placeholder"});f.sortable({helper:"clone",opacity:.9,connectWith:N,cursor:"move",placeholder:"ui-state-highlight",start:o.startMoving,stop:o.stopMoving,revert:150,change:function(e,t){},remove:function(t,l){0===a?f.prepend(l.item):e("li:nth-child("+a+")",f).after(l.item)},beforeStop:function(t,l){var a=e("> li",N).length-1,i=l.placeholder.index();s=1>=i||i===a?!0:!1,l.placeholder.parent().hasClass("frmb-control")&&(s=!0)},update:function(t,l){r.stopIndex=0===e("li",N).index(l.item)?"0":e("li",N).index(l.item),e("li",N).index(l.item)<0?e(this).sortable("cancel"):A(e(l.item[0]),!0)},receive:function(t,l){(l.sender.hasClass("frmb")||l.sender.hasClass("frmb-control"))&&e(l.sender).sortable("cancel")}});var q=e("<div/>",{id:c+"-stage-wrap","class":"stage-wrap"}),F=e("<div/>",{id:c+"-form-wrap","class":"form-wrap"});r.before(q).appendTo(q);var L=e("<div/>",{id:c+"-cb-wrap","class":"cb-wrap"}).append(b,f);q.append(N,L,E,x,C),q.before(F),F.append(q,L);var O=function(){if(0===e(this).parents("li.disabled").length){if("label"===e(this).name&&""===e(this).val())return alert("Error: "+n.messages.labelEmpty);o.save()}};e("input, select",N).on("change",O),e("input, select",N).on("blur",O),r.getTemplate=function(){var t=""!==r.val()?e.parseXML(r.val()):!1,l=e(t).find("field");if(l.length>0)l.each(function(){A(e(this))});else if(!t){if(n.defaultFields.length)for(var a=n.defaultFields.length-1;a>=0;a--)R(n.defaultFields[a]);else q.addClass("empty").attr("data-content",n.messages.getStarted);D()}};var D=function(){var t='<li class="disabled __POSITION__">__CONTENT__</li>';n.disableFields.before&&!e(".disabled.before",N).length&&N.prepend(t.replace("__POSITION__","before").replace("__CONTENT__",n.disableFields.before)),n.disableFields.after&&!e(".disabled.after",N).length&&N.append(t.replace("__POSITION__","after").replace("__CONTENT__",n.disableFields.after))},I=function(e){var t=(new Date).getTime();return e.data("attrs").name+"-"+t},A=function(t,l){l=l||!1;var a=t.data("attrs")||{},s=a.type||t.attr("type"),i=s.match(/(select|checkbox-group|radio-group)/),n={};n.label=o.htmlEncode(t.attr("label")),n.name=l?I(t):a.name||t.attr("name"),n.role=t.attr("role"),n.required=t.attr("required"),n.maxLength=t.attr("max-length"),n.toggle=t.attr("toggle"),n.type=s,n.description=void 0!==t.attr("description")?o.htmlEncode(t.attr("description")):"",i&&(n.multiple=!0,n.values=[],t.children().each(function(l){var a={label:e(this).text(),value:e(this).attr("value"),selected:t.attr("default")===l?!0:!1};n.values.push(a)})),R(n),q.removeClass("empty"),D()},S=function(e){W(n.messages.richText,X(e),e)},B=function(e){var t=e.type||"text";W(n.messages[t],X(e),e)},P=function(t){t.values&&t.values.length||(t.values=[{selected:"false",label:"Option 1",value:"option-1"},{selected:"false",label:"Option 2",value:"option-2"}]);var l="",a=o.safename(t.name),s=("checkbox-group"===t.type,"none");for(l+=X(t),l+='<div class="false-label">'+n.messages.selectOptions+"</div>",l+='<div class="fields">',l+='<div class="allow-multi" style="display:'+s+'">',l+='<input type="checkbox" id="multiple_'+p+'" name="multiple"'+(t.multiple?'checked="checked"':"")+">",l+='<label class="multiple" for="multiple_'+p+'">'+n.messages.selectionsMessage+"</label>",l+="</div>",l+='<ol class="sortable-options">',v=0;v<t.values.length;v++)l+=G(t.values[v],a,t.values[v].selected,t.multiple);l+="</ol>",l+='<div class="field_actions"><a href="#" class="add add_opt"><strong>'+n.messages.add+'</strong></a> | <a href="#" class="close_field">'+n.messages.close+"</a></div>",l+="</div>",W(n.messages.select,l,t),e(".sortable-options").sortable()},R=function(e){void 0===e&&(e="");var t={2:B,date:B,autocomplete:B,checkbox:B,select:P,"rich-text":S,textarea:S,"radio-group":P,"checkbox-group":P,text:B};"function"==typeof t[e.type]&&t[e.type](e)},X=function U(t){var l,U="",a=void 0!==t.role?t.role.split(","):[],s=e("<div>",{"class":"frm-fld label-wrap"});e("<label/>").html(n.messages.label+" *").appendTo(s),e("<input>",{type:"text",name:"label",value:t.label,"class":"fld-label"}).appendTo(s),U+=s[0].outerHTML;var i=e("<div>",{"class":"frm-fld description-wrap"});e("<label/>").html(n.messages.description+" *").appendTo(i),U+='<div class="frm-fld description-wrap"><label>'+n.messages.description+"</label>",U+='<input type="text" name="description" value="'+t.description+'" class="fld-description" id="description-'+p+'" /></div>',U+='<div class="frm-fld name-wrap"><label>'+n.messages.name+' <span class="required">*</span></label>',U+='<input type="text" name="name" value="'+t.name+'" class="fld-name" id="title-'+p+'" /></div>',U+='<div class="frm-fld access-wrap"><label>'+n.messages.roles+"</label>",U+='<input type="checkbox" name="enable_roles" value="" '+(void 0!==t.role?"checked":"")+' id="enable_roles-'+p+'"/> <label for="enable_roles-'+p+'" class="roles_label">'+n.messages.limitRole+"</label>",U+='<div class="frm-fld available-roles" '+(void 0!==t.role?'style="display:block"':"")+">";for(l in n.roles)-1===e.inArray(l,["date","4"])&&(U+='<input type="checkbox" name="roles[]" value="'+l+'" id="fld-'+p+"-roles-"+l+'" '+(-1!==e.inArray(l,a)?"checked":"")+' class="roles-field" /><label for="fld-'+p+"-roles-"+l+'">'+n.roles[l]+"</label><br/>");return U+="</div></div>",e.inArray(t.type,["checkbox","select","checkbox-group","date","autocomplete","radio-group"])<0&&(U+='<div class="frm-fld"><label class="max-length-label">'+n.messages.maxLength+"</label>",U+='<input type="text" name="max-length" max-length="4" value="'+(void 0!==t.maxLength?t.maxLength:"")+'" class="fld-max-length" id="max-length-'+p+'" /></div>'),U},W=function(t,l,a){var s=""!==e(l).find('input[name="label"]').val()?e(l).find('input[name="label"]').val():t,i="",c='<a id="del_'+p+'" class="del-button btn delete-confirm" href="#" title="'+n.messages.removeMessage+'">'+n.messages.remove+"</a>",d='<a id="frm-'+p+'" class="toggle-form btn icon-pencil" href="#" title="'+n.messages.hide+'"></a> ',m=a.required,u=a.toggle||void 0,f=""!==a.description?'<span class="tooltip-element" tooltip="'+a.description+'">?</span>':"";i+='<li id="frm-'+p+'-item" class="'+a.type+' form-field">',i+='<div class="legend">',i+=c,i+='<span id="txt-title-'+p+'" class="field-label">'+s+"</span>"+f+'<span class="required-asterisk" '+("true"===m?'style="display:inline"':"")+"> *</span>"+d,i+="</div>",i+='<div class="prev-holder">'+j(a)+"</div>",i+='<div id="frm-'+p+'-fld" class="frm-holder">',i+='<div class="form-elements">',i+='<div class="frm-fld">',i+="<label>&nbsp;</label>",i+='<input class="required" type="checkbox" value="1" name="required-'+p+'" id="required-'+p+'"'+("true"===m?' checked="checked"':"")+' /><label class="required_label" for="required-'+p+'">'+n.messages.required+"</label>","checkbox"===a.type&&(i+='<div class="frm-fld">',i+="<label>&nbsp;</label>",i+='<input class="checkbox-toggle" type="checkbox" value="1" name="toggle-'+p+'" id="toggle-'+p+'"'+("true"===u?' checked="checked"':"")+' /><label class="toggle-label" for="toggle-'+p+'">'+n.messages.toggle+"</label>",i+="</div>"),i+="</div>",i+=l,i+="</div>",i+="</div>",i+="</li>",r.stopIndex?e("li",N).eq(r.stopIndex).after(i):N.append(i),e(document.getElementById("frm-"+p+"-item")).hide().slideDown(250),p++,o.save()},j=function(e){var t,l="",a=(new Date).getTime();switch(e.type){case"textarea":l="<"+e.type+"></"+e.type+">";break;case"select":var s;for(e.values.reverse(),t=e.values.length-1;t>=0;t--)s+='<option value="'+e.values[t].value+'">'+e.values[t].label+"</option>";l="<"+e.type+' class="no-drag">'+s+"</"+e.type+">";break;case"checkbox-group":case"radio-group":var i=e.type.replace("-group","");for(e.values.reverse(),t=e.values.length-1;t>=0;t--)l+='<div><input type="'+i+'" id="'+i+"-"+a+"-"+t+'" value="'+e.values[t].value+'" /><label for="'+i+"-"+a+"-"+t+'">'+e.values[t].label+"</label></div>";break;case"text":case"password":case"email":case"date":case"checkbox":var o=e.toggle?"toggle":"";l='<input type="'+e.type+'" '+o+' placeholder="">';break;case"autocomplete":l='<input class="ui-autocomplete-input" autocomplete="on" placeholder="">';break;default:l="<"+e.type+"></"+e.type+">"}return l},G=function(e,t,l,a){var s=a?"checkbox":"radio";return"object"!=typeof e?e={label:"",value:""}:(e.label=e.label||"",e.value=e.value||""),d="<li>",d+='<input type="'+s+'" '+l+' class="select-option" name="'+t+'" />',d+='<input type="text" class="option-label" placeholder="'+n.messages.optionLabelPlaceholder+'" value="'+e.label+'" />',d+='<input type="text" class="option-value" placeholder="'+n.messages.optionValuePlaceholder+'" value="'+e.value+'" />',d+='<a href="#" class="remove btn" title="'+n.messages.removeMessage+'">'+n.messages.remove+"</a>",d+="</li>"};N.delegate(".remove","click",function(t){t.preventDefault();var l=e(this).parents(".sortable-options:eq(0)").children("li").length;2>=l?alert("Error: "+n.messages.minOptionMessage):e(this).parent("li").slideUp("250",function(){e(this).remove()})}),N.on("click",".toggle-form",function(t){t.preventDefault();var l=e(this).attr("id");e(this).toggleClass("open").parent().next(".prev-holder").slideToggle(250),e(document.getElementById(l+"-fld")).slideToggle(250,function(){o.save()})}),N.delegate('input[name="label"]',"keyup",function(){e(".field-label",e(this).closest("li")).text(e(this).val())}),N.delegate("input.error","keyup",function(){e(this).removeClass("error")}),N.delegate('input[name="description"]',"keyup",function(){var t=e(".tooltip-element",e(this).closest("li"));if(""!==e(this).val())if(t.length)t.attr("tooltip",e(this).val()).css("display","inline-block");else{var l='<span class="tooltip-element" tooltip="'+e(this).val()+'">?</span>';e(".toggle-form",e(this).closest("li")).before(l)}else t.length&&t.css("display","none")}),o.updateMultipleSelect(),N.delegate('input[name="name"]',"keyup",function(){e(this).val(o.safename(e(this).val())),""===e(this).val()?e(this).addClass("field_error").attr("placeholder",n.messages.cannotBeEmpty):e(this).removeClass("field_error")}),N.delegate("input.fld-max-length","keyup",function(){e(this).val(o.forceNumber(e(this).val()))}),N.delegate(".delete-confirm","click",function(t){t.preventDefault();var l=e("<h3/>").html("<span></span>"+n.messages.warning),a=e(this).attr("id").replace(/del_/,""),s=e(this),i=e(document.getElementById("frm-"+a+"-item")),r=s.offset().left-e(window).scrollLeft(),c=s.offset().top-e(window).scrollTop();n.showWarning?jQuery("<div />").append(l,n.messages.fieldRemoveWarning).dialog({modal:!0,resizable:!1,width:300,dialogClass:"ite-warning",open:function(){e(".ui-widget-overlay").css({opacity:0})},position:[r-282,c-178],buttons:[{text:n.messages.yes,click:function(){i.slideUp(250,function(){e(this).remove(),o.save()}),e(this).dialog("close")}},{text:n.messages.no,"class":"cancel",click:function(){e(this).dialog("close")}}]}):i.slideUp(250,function(){e(this).remove(),o.save()}),1===e(".form-field",N).length&&q.addClass("empty")}),N.delegate("input.required","click",function(){var t=e(this).parents("li.form-field").find(".required-asterisk");t.toggle()}),N.delegate('input[name="enable_roles"]',"click",function(){var t=e(this).siblings("div.available-roles"),l=e(this);t.slideToggle(250,function(){l.is(":checked")||e('input[type="checkbox"]',t).removeAttr("checked")})}),N.delegate(".add_ck","click",function(){return e(this).parent().before(G()),!1}),N.delegate("li.disabled .form-element","mouseenter",function(){o.disabledTT(e(this))}),N.delegate(".add_opt","click",function(t){t.preventDefault();var l=e(this).parents(".fields").first().find('input[name="multiple"]')[0].checked,a=e(this).parents(".fields").find(".select-option:eq(0)").attr("name");e(this).parents(".fields").first().find(".sortable-options").append(G(!1,a,!1,l)),o.updateMultipleSelect()}),N.delegate(".close_field","click",function(t){t.preventDefault(),e(this).parents("li.form-field").find(".toggle-form").trigger("click")}),N.delegate(".add_rd","click",function(t){t.preventDefault(),e(this).parent().before(G(!1,e(this).parents(".frm-holder").attr("id")))}),e(".form-elements .fields .remove, .frmb .del-button").on("hover",function(){e(this).parents("li.form-field").toggleClass("delete")}),e(document.getElementById(c+"-export-xml")).click(function(t){t.preventDefault();var l=r.val(),a=e("<pre />").text(l);a.dialog({resizable:!1,modal:!0,width:720,dialogClass:"frmb-xml",overlay:{color:"#333333"}})}),e(document.getElementById(c+"-clear-all")).click(function(e){if(e.preventDefault(),window.confirm(n.messages.clearAllMessage)){N.empty(),r.val(""),o.save();var t={label:[n.messages.descriptionField],name:["content"],required:"true",description:n.messages.mandatory};R(t),N.prepend(n.disableFields.before),N.append(n.disableFields.after)}}),e(document.getElementById(c+"-save")).click(function(t){0===e(this).find(".ldkInlineEdit").length&&(t.preventDefault(),q.hasClass("edit-xml")||o.save(),o.validateForm(t))});var V=!1,z=[],Q="68,69,86";e(".save.fb-button").mouseover(function(){V=!0}).mouseout(function(){V=!1}),e(document.documentElement).keydown(function(t){z.push(t.keyCode),z.toString().indexOf(Q)>=0&&(e(".action-links").toggle(),e(".view-xml").toggle(),z=[])}),e(".dev-mode-link").click(function(t){t.preventDefault();var l=e(this);q.toggleClass("dev-mode"),l.parent().css("opacity",1),q.hasClass("dev-mode")?(l.siblings(".action-links-inner").css("width","100%"),l.html(n.messages.devMode+" "+n.messages.on).css("color","#8CC63F")):(l.siblings(".action-links-inner").css("width",0),l.html(n.messages.devMode+" "+n.messages.off).css("color","#666666"),V=!1,e(".action-links").toggle(),e(".view-xml").toggle())}),e(document.getElementById(c+"-edit-names")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e(".name-wrap",N).slideToggle(250,function(){q.toggleClass("edit-names")})}),e(document.getElementById(c+"-allow-select")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e(".allow-multi, .select-option",N).slideToggle(250,function(){q.toggleClass("allow-select")})}),e(document.getElementById(c+"-edit-xml")).click(function(t){t.preventDefault(),e(this).toggleClass("active"),e("textarea.idea-template").show(),e(".template-textarea-wrap").slideToggle(250),q.toggleClass("edit-xml")}),r.parent().find('p[id*="ideaTemplate"]').remove(),r.wrap('<div class="template-textarea-wrap"/>'),r.getTemplate()};e.fn.formBuilder=function(l){var a=this;return a.each(function(){var a=e(this);if(!a.data("formBuilder")){var s=new t(this,l);a.data("formBuilder",s)}})}}(jQuery),function(e){e.fn.toXML=function(t){var l={prepend:"",attributes:["class"]},a=e.extend(l,t),s="";return this.each(function(){var t=0,l=1;e(this).children().length>=1&&(s+="<form-template>\n	<fields>",e(this).children().each(function(){var i=e(this);if(!i.hasClass("moving")&&!i.hasClass("disabled"))for(var o=0;o<a.attributes.length;o++){var n=e("input.required",i).is(":checked")?'required="true" ':'required="false" ',r=e('input[name="multiple"]',i).is(":checked"),c=r?'style="multiple" ':"",d=i.attr(a.attributes[o]).replace(" form-field",""),p=d.match(/(select|checkbox-group|radio-group)/),m='type="'+d+'" ',u='name="'+e("input.fld-name",i).val()+'" ',f='label="'+e("input.fld-label",i).val()+'" ',v=e.map(e("input.roles-field:checked",i),function(e){return e.value}).join(","),h=""!==v?'role="'+v+'" ':"",g='description="'+e("input.fld-description",i).val()+'" ',b=e("input.fld-max-length",i).val(),x='max-length="'+(void 0!==b?b:"")+'" ',k=p?"":"/",y=e(".checkbox-toggle",i).is(":checked")?'toggle="true" ':"";s+="\n		<field "+u+f+y+c+h+g+(""!==b&&void 0!==b?x:"")+n+m+k+">",p&&(l=1,e(".sortable-options li",i).each(function(){var t=e(this),a='value="'+e(".option-value",t).val()+'"',i=e(".option-label",t).val(),o=e(".select-option",t).is(":checked")?' selected="true"':"";s+="\n			<option"+o+" "+a+">"+i+"</option>",l++}),s+="\n		</field>")}t++}),s+="\n	</fields>\n</form-template>")}),s}}(jQuery);